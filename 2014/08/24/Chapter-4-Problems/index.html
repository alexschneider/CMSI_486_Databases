<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Chapter 4 Problems | CMSI 486</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Notes:

SQL is a standard language that all implementations must follow.
SQL has several data types - numeric, character/string, bit-string, boolean, and date
Constraints can further limit the data in">
<meta property="og:type" content="article">
<meta property="og:title" content="Chapter 4 Problems">
<meta property="og:url" content="http://alexschneider.github.io/CMSI_486_Databases/CMSI_486_Databases/2014/08/24/Chapter-4-Problems/">
<meta property="og:site_name" content="CMSI 486">
<meta property="og:description" content="Notes:

SQL is a standard language that all implementations must follow.
SQL has several data types - numeric, character/string, bit-string, boolean, and date
Constraints can further limit the data in">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Problems">
<meta name="twitter:description" content="Notes:

SQL is a standard language that all implementations must follow.
SQL has several data types - numeric, character/string, bit-string, boolean, and date
Constraints can further limit the data in">

  
    <link rel="alternative" href="/atom.xml" title="CMSI 486" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="http://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/CMSI_486_Databases/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/CMSI_486_Databases/" id="logo">CMSI 486</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/CMSI_486_Databases/" id="subtitle">Databases Independent Study</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://alexschneider.github.io/CMSI_486_Databases"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Chapter-4-Problems" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/CMSI_486_Databases/2014/08/24/Chapter-4-Problems/" class="article-date">
  <time datetime="2014-08-24T21:09:38.000Z" itemprop="datePublished">Aug 24th 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Chapter 4 Problems
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Notes:</p>
<ul>
<li>SQL is a standard language that all implementations must follow.</li>
<li>SQL has several data types - numeric, character/string, bit-string, boolean, and date</li>
<li>Constraints can further limit the data input in a table, such as verifying the size of the data, setting default values, or preventing NULLs from occurring<ul>
<li>Constraints can be named</li>
<li>Constraints help enforce integrity of data</li>
</ul>
</li>
<li>SQL has a retrieval statement called “SELECT”<ul>
<li>Usually paired with “FROM” and “WHERE”</li>
<li>Where clause limits the rows returned from the select statement</li>
</ul>
</li>
<li>SQL has a pattern matching statment called “LIKE”</li>
</ul>
<a id="more"></a>

<p>4.5. Consider the database shown in Figure 1.2, whose schema is shown in Figure 2.1. What are the referential integrity constraints that should hold on then schema? Write appropriate SQL DDL statements to define the database</p>
<p>Constraints:</p>
<ul>
<li>Student_number PRIMARY</li>
<li>Course_number PRIMARY</li>
<li>Course_name UNIQUE</li>
<li>Section_identifier PRIMARY</li>
<li>Grade IN (“A”, “B”, “C”, “D”, “F”)<br>4.6. Repeat Exercise 4.5, but use the AIRLINE database schema of Figure 3.8.</li>
</ul>
<p>Constraints:</p>
<ul>
<li>Airport_code PRIMARY</li>
<li>Flight_number PRIMARY</li>
<li>Weekdays BETWEEN 0 AND 6</li>
<li>Leg_number PRIMARY</li>
<li>Airplane_type_name PRIMARY</li>
<li>Airplane_id PRIMARY</li>
</ul>
<p>4.7. Consider the LIBRARY relational database schema shown in Figure 4.6. Choose the appropriate action (reject, cascade, set to NULL , set to default) for each referential integrity constraint, both for the deletion of a referenced tuple and for the update of a primary key attribute value in a referenced tuple. Justify your choices.</p>
<ul>
<li>Book_id - CASCADE - without a book_id, there’ll be no book_author, no book copies, or book loans</li>
<li>Name (publisher) - REJECT on update - once a book has been published, the publisher cannot change for pre-existing copies of a book. Set to NULL on delete - ensure that no denormalized data exists.</li>
<li>Branch_id - CASCADE on update (there shouldn’t be any updates really), REJECT on delete - books need to be manually moved</li>
<li>Card_no - CASCADE on update (shouldn’t be any updates), set to NULL on deletes</li>
</ul>
<p>4.9. How can the key and foreign key constraints be enforced by the DBMS? Is the enforcement technique you suggest difficult to implement? Can the constraint checks be executed efficiently when updates are applied to the database?</p>
<p>Key and foreign key constraints can be enforced by the DBMS by using a metatable of them, and whenever a query (UPDATEs and DELETEs) that could possibly run up against the restrictions, query the meta-table to see if there is a constraint.</p>
<p>The technique would require an additional query to be run for all updates and deletes, which increases overhead, but is rather simple to implement.</p>
<p>4.10. Specify the following queries in SQL on the COMPANY relational database<br>schema shown in Figure 3.5. Show the result of each query if it is applied to the COMPANY database in Figure 3.6.<br>a. Retrieve the names of all employees in department 5 who work more than 10 hours per week on the ProductX project.<br>b. List the names of all employees who have a dependent with the same first name as themselves.</p>
<p>a.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> e.Fname <span class="keyword">FROM</span> EMPLOYEE e <span class="keyword">INNER</span> <span class="keyword">JOIN</span> WORKS_ON w <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Project p <span class="keyword">ON</span> e.Ssn = w.Essn, p.Pnumber=w.Pno <span class="keyword">WHERE</span> w.Hours &gt; <span class="number">10</span>  <span class="keyword">AND</span> p.Pname=<span class="string">'ProjectX'</span></span></div></pre></td></tr></table></figure>

<p>Result:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">John</span></div><div class="line">Joyce</div></pre></td></tr></table></figure>

<p>b.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> e.Fname <span class="keyword">FROM</span> EMPLOYEE e <span class="keyword">INNER</span> <span class="keyword">JOIN</span> DEPENDENT d <span class="keyword">ON</span> e.Ssn = d.Essn <span class="keyword">WHERE</span> d.Dependant_name=e.Fname</span></div></pre></td></tr></table></figure>

<p>Result:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">no</span> results)</span></div></pre></td></tr></table></figure>

<p>4.11. Specify the updates of Exercise 3.11 using the SQL update commands.<br>a. <code>INSERT INTO EMPLOYEE VALUES (‘Robert’, ‘F’, ‘Scott’, ‘943775543’, ‘1972-06-21’, ‘2365 Newcastle Rd, Bellaire, TX’, M, 58000, ‘888665555’, 1)</code><br>b. <code>INSERT INTO PROJECT VALUES (&#39;ProductA&#39;, 4, &#39;Bellaire&#39;, 2)</code><br>c. <code>INSERT INTO DEPARTMENT VALUES (‘Production’, 4, ‘943775543’, ‘2007-10-01’)</code><br>d. <code>INSERT INTO WORKS_ON VALUES (&#39;677678989&#39;, NULL, &#39;40.0&#39;)</code><br>e. <code>INSERT INTO DEPENDENT VALUES (‘453453453’, ‘John’, ‘M’, ‘1990-12-12’, ‘spouse’)</code><br>f. <code>DELETE FROM WORKS_ON WHERE Essn=&#39;333445555&#39;</code><br>g. <code>DELETE FROM EMPLOYEE WHERE Ssn=&#39;987654321&#39;</code><br>h. <code>DELETE FROM PROJECT WHERE Pname=&#39;ProductX&#39;</code><br>i. <code>UPDATE DEPARTMENT SET Mgr_ssn=&#39;123456789&#39;, Mgr_start_date=&#39;2007-10-01&#39; WHERE Dnumber=5</code><br>j. <code>UPDATE EMPLOYEE SET Super_ssn=&#39;943775543&#39; WHERE Ssn=&#39;999887777&#39;</code><br>k. <code>UPDATE WORKS_ON SET Hours=&#39;5.0&#39; WHERE Essn=&#39;999887777&#39; AND Pno=10</code></p>
<p>4.12 Specify the following queries in SQL on the database schema of Figure 1.2.<br>a. Retrieve the names of all senior students majoring in ‘CS’ (computer science).<br>b. Retrieve the names of all courses taught by Professor King in 2007 and 2008.<br>c. For each section taught by Professor King, retrieve the course number, semester, year, and number of students who took the section.<br>d. Retrieve the name and transcript of each senior student (Class = 4) majoring in CS. A transcript includes course name, course number, credit hours, semester, year, and grade for each course completed by the student.</p>
<p>a. <code>SELECT Name FROM STUDENT WHERE Major=&#39;CS&#39;</code><br>b. <code>SELECT c.Course_name FROM COURSE c INNER JOIN SECTION s ON c.Course_number=s.Course_number WHERE s.Instructor=&#39;King&#39; AND (YEAR=08 OR YEAR=09)</code><br>c. <code>SELECT s.Course_number, s.Semester, s.Year, COUNT(g.Student_number) FROM GRADE_REPORT g INNER JOIN SECTION s ON g.Section_identifier=s.Section_identifier WHERE s.Instructor=&#39;King&#39;</code><br>d.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">SELECT</span> st.Name, c.Course_name, sec.Course_number, c.Credit_hours, sec.Semester, sec.<span class="keyword">Year</span>, g.Grade</span></div><div class="line">  <span class="keyword">FROM</span> STUDENT st</div><div class="line">  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> GRADE_REPORT g <span class="keyword">ON</span> st.Student_number=g.Student_number</div><div class="line">  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">SECTION</span> sec <span class="keyword">ON</span> sec.Section_identifier=g.Section_identifier</div><div class="line">  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> COURSE c <span class="keyword">ON</span> sec.Course_number=c.Course_number</div><div class="line"><span class="keyword">WHERE</span> st.Class=<span class="number">4</span></div></pre></td></tr></table></figure>

<p>4.13. Write SQL update statements to do the following on the database schema shown in Figure 1.2.<br>a. Insert a new student, &lt;‘Johnson’, 25, 1, ‘Math’&gt;, in the database.<br>b. Change the class of student ‘Smith’ to 2.<br>c. Insert a new course, &lt;‘Knowledge Engineering’, ‘CS4390’, 3, ‘CS’&gt;.<br>d. Delete the record for the student whose name is ‘Smith’ and whose stu-<br>dent number is 17.</p>
<p>a. <code>INSERT INTO STUDENT VALUES (&#39;Johnson&#39;, 25, 1, &#39;MATH&#39;)</code><br>b. <code>UPDATE STUDENT SET Class=2</code><br>c. <code>INSERT INTO COURSE VALUES (‘Knowledge Engineering’, ‘CS4390’, 3, ‘CS’)</code><br>d. <code>DELETE FROM STUDENT WHERE Student_number=17 AND Name=&#39;Smith&#39;</code></p>
<p>4.15. Consider the EMPLOYEE table’s constraint EMPSUPERFK as specified in<br>Figure 4.2 is changed to read as follows:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CONSTRAINT EMPSUPERFK</div><div class="line">FOREIGN KEY ( Super_ssn ) REFERENCES EMPLOYEE ( Ssn )</div><div class="line">ON <span class="operator"><span class="keyword">DELETE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> ,</span></div></pre></td></tr></table></figure>

<p>Answer the following questions:<br>a. What happens when the following command is run on the database state shown in Figure 3.6?</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">DELETE</span> EMPLOYEE <span class="keyword">WHERE</span> Lname = ‘Borg’</span></div></pre></td></tr></table></figure>

<p>b. Is it better to CASCADE or SET NULL in case of EMPSUPERFK constraint ON DELETE ?</p>
<p>a. The employee’s boss will also be deleted.<br>b. It is probably better to SET NULL, since the employee can get a new boss and the employee being fired doesn’t necessarily mean that their boss gets fired too.</p>
<p>4.16. Write SQL statements to create a table EMPLOYEE_BACKUP to back up the EMPLOYEE table shown in Figure 3.6.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> EMPLOYEE_BACKUP <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> EMPLOYEE</span></div></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://alexschneider.github.io/CMSI_486_Databases/2014/08/24/Chapter-4-Problems/" data-id="cpnzhqhhc1zveglt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/CMSI_486_Databases/2014/08/24/Chapter-5-Problems/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Chapter 5 Problems
        
      </div>
    </a>
  
  
    <a href="/CMSI_486_Databases/2014/08/18/week-ten/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Week Ten to Thirteen</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/CMSI_486_Databases/categories/Exercises/">Exercises</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/CMSI_486_Databases/categories/Readings/">Readings</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/CMSI_486_Databases/categories/Weekly-Updates/">Weekly Updates</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/CMSI_486_Databases/categories/pyORMatic/">pyORMatic</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/CMSI_486_Databases/archives/2014/09">September 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/CMSI_486_Databases/archives/2014/08">August 2014</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/CMSI_486_Databases/archives/2014/07">July 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/CMSI_486_Databases/archives/2014/06">June 2014</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/CMSI_486_Databases/2014/09/01/Week-Sixteen/">Week Sixteen</a>
          </li>
        
          <li>
            <a href="/CMSI_486_Databases/2014/09/01/F1-Database/">F1 Database</a>
          </li>
        
          <li>
            <a href="/CMSI_486_Databases/2014/09/01/Pros-and-Cons-of-MongoDB/">Pros and Cons of Mongo Db</a>
          </li>
        
          <li>
            <a href="/CMSI_486_Databases/2014/09/01/Methods-and-Procedures/">Methods and Procedures</a>
          </li>
        
          <li>
            <a href="/CMSI_486_Databases/2014/08/30/Chapter-18-Problems/">Chapter 18 Problems</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2014 Alex Schneider<br>
      Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/CMSI_486_Databases/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/CMSI_486_Databases/fancybox/jquery.fancybox.pack.js"></script>


<script src="/CMSI_486_Databases/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>